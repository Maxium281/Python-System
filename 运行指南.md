# Python 面试题学习系统 - 运行指南（单机版）

本系统基于 Flask + SQLite，本地运行即可使用：题库分类、答题判分、解析展示、收藏/错题本、学习进度统计、模拟面试（限时随机抽题）。

## 系统要求

- Python 3.8+（建议 3.10/3.11）
- pip

## 快速开始

### 1) 安装依赖

在项目根目录执行：

```bash
pip install -r requirements.txt
```

### 2) 准备题库（导入 JSON）

系统数据库文件为 database/interview.db。

- 首次运行 `python run.py` 会自动创建表结构（users/questions/answers/attempts/favorites）。
- 题目数据建议通过脚本导入：

生成示例 JSON：

```bash
python scripts/batch_import_questions.py --sample
```

导入到数据库：

```bash
python scripts/batch_import_questions.py sample_questions.json
```

JSON 格式要求（每道题）：

```json
{
	"category": "Python Basics",
	"title": "题目内容",
	"option_a": "选项A",
	"option_b": "选项B",
	"option_c": "选项C",
	"option_d": "选项D",
	"correct_answer": "A",
	"difficulty": "Easy",
	"is_high_frequency": true,
	"analysis": "解析",
	"knowledge_point": "考点"
}
```

提示：data/initial_questions.json 使用 `options: {A:...,B:...}` 的结构，与导入脚本格式不同；如需使用该文件，请先转换字段。

### 3) 启动应用

```bash
python run.py
```

### 4) 访问应用

- http://127.0.0.1:5000/

## 主要功能页面

- 首页：http://127.0.0.1:5000/
- 题库分类：http://127.0.0.1:5000/question/category
- 答题页：http://127.0.0.1:5000/question/answer?question_id=1
- 解析页：http://127.0.0.1:5000/question/explanation/1
- 学习进度：http://127.0.0.1:5000/progress/
- 模拟面试：http://127.0.0.1:5000/exam/mock

## 环境变量配置（可选）

应用主要通过环境变量控制：

- `HOST`：监听地址（默认 `127.0.0.1`）
- `PORT`：端口（默认 `5000`）
- `DEBUG`：是否启用调试（`1`/`0`，默认 `0`）
- `SECRET_KEY`：session 密钥（模拟面试依赖 session；默认值适合本地开发）

Windows PowerShell 示例：

```powershell
$env:PORT = "5001"
$env:DEBUG = "1"
python run.py
```

Windows CMD 示例：

```bat
set PORT=5001
set DEBUG=1
python run.py
```

## 调试接口（用于确认当前实例）

- http://127.0.0.1:5000/__debug/ping
- http://127.0.0.1:5000/__debug/info

响应头会包含 `X-App-Instance`，用于排查“我改了代码但页面没变化/跑错进程”。

## 常见问题

### 1) 页面一直“加载中”

通常是前端 JS 没执行（例如某个静态 JS 文件内容不是合法 JS）。

- 打开开发者工具（F12）查看 Console 与 Network
- 确认接口 `http://127.0.0.1:5000/question/api/questions?category=basic` 能返回 JSON

历史问题：如果 static/js/jquery-3.6.0.min.js 文件开头被误加了 `# -*- coding: utf-8 -*-`，浏览器会报 `Invalid or unexpected token`，删除该行即可。

### 2) 端口被占用

改用其他端口：

```powershell
$env:PORT = "5001"
python run.py
```

### 3) 数据库相关问题

- 确认 database/interview.db 可写
- 删除 database/interview.db 后重新运行（会自动建表；题目需重新导入）

## 测试

```bash
pytest -q
```

## 停止应用

在运行 `python run.py` 的终端里按 `Ctrl + C`。

